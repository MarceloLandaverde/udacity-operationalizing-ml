


# Operationalizing Machine Learning
The main steps of the project will be the following:

- Authentication \
https://docs.microsoft.com/en-us/azure/machine-learning/how-to-setup-authentication
- Automated ML Experiment \
https://docs.microsoft.com/en-us/azure/machine-learning/how-to-configure-auto-train
- Deploy the best model \
https://docs.microsoft.com/en-us/azure/machine-learning/how-to-deploy-azure-container-instance
- Enable logging \
https://docs.microsoft.com/en-us/azure/machine-learning/how-to-enable-app-insights
- Swagger Documentation \
https://swagger.io/tools/swagger-ui/
- Consume model endpoints \
https://docs.microsoft.com/en-us/azure/machine-learning/how-to-consume-web-service?tabs=python
- Create and publish a pipeline \
https://docs.microsoft.com/en-us/azure/machine-learning/concept-ml-pipelines
https://docs.microsoft.com/en-us/azure/machine-learning/how-to-create-machine-learning-pipelines
https://docs.microsoft.com/en-us/azure/machine-learning/how-to-deploy-pipelines
https://docs.microsoft.com/en-us/python/api/azureml-pipeline-core/azureml.pipeline.core.pipeline_endpoint.pipelineendpoint?view=azure-ml-py
- Documentation

## Architectural Diagram
The following diagram should help us to visualize the flow of operations from start to finish. This diagramm should be self-explanatory but if not then 
you can map this diagram with the information and code of the Jupyter notebook ( aml-pipelines-with-automated-machine-learning-step-2.ipynb)
https://github.com/MarceloLandaverde/udacity-operationalizing-ml/blob/master/starter_files/aml-pipelines-with-automated-machine-learning-step-2.ipynb

![alt text](https://github.com/MarceloLandaverde/udacity-operationalizing-ml/blob/master/Arc_Diagramm.PNG)

## Key Steps

***Model Deployment:*** \
To be able to deploy a model the following “Key” steps should occur:

*Enable Security and Authentication* \
This is the first step needed, then authentication is crucial for the continuous flow of operations. In this project the security and authentication steps will be generated by creating a “Service Principal”.

A “Service Principal” is a user role with controlled permissions to access specific resources. Using a service principal is a great way to allow authentication while reducing the scope of permissions, which enhances security.

In the current project the udacity lab was used, thus there was no need for creating the above mentioned steps. Nevertheless below you will find the generic steps of how this could get done:

- Using the terminal ensure the az command-line tool is installed along with the ml extension
- Authenticate
- Create the “Service Principal” 
![alt text](https://github.com/MarceloLandaverde/udacity-operationalizing-ml/blob/master/1_Creating_SP.PNG)
Afterwards:
- Capture the "objectId" using the clientID
- Assign the role to the new Service Principal for the given Workspace, Resource Group and User objectId
![alt text](https://github.com/MarceloLandaverde/udacity-operationalizing-ml/blob/master/2_Creating_SP_Role_Owner.PNG)

***Create and run AutoML Experiment:*** \
At this point, security is enabled and authentication is completed. In this step an experiment using Automated ML will be created. This includes to configure a compute cluster and use that cluster to run the experiment.

For the experiment, the “Bankmarketing dataset” will be used as input:

##### Registered Datasets:
![alt text](https://github.com/MarceloLandaverde/udacity-operationalizing-ml/blob/master/1-Registered_Datasets.PNG)

Once the experiment is completed the best model will be selected as you can see in the pictures below:

##### Experiment Run completed:
![alt text](https://github.com/MarceloLandaverde/udacity-operationalizing-ml/blob/master/2-Run_Completed.PNG)

##### Best Model:
![alt text](https://github.com/MarceloLandaverde/udacity-operationalizing-ml/blob/master/3-Best_Model.PNG)

***Deploy the Best Model:***\
After the experiment run completes, a summary of all the models and their metrics are shown, including explanations. In this case the best model will be selected to be deployed.

##### Best Model:
![alt text](https://github.com/MarceloLandaverde/udacity-operationalizing-ml/blob/master/3-Best_Model.PNG)

***Enable Application Insights:***\
The next will be to activate “Application Insights” which is a particularly useful tool to detect anomalies and visualize performance.

##### Application Insights Enable:
![alt text](https://github.com/MarceloLandaverde/udacity-operationalizing-ml/blob/master/4-Application_Insights.PNG)

Enabling Application Insights will be done in this case using the following python script:
##### logs.py file:
![alt text](https://github.com/MarceloLandaverde/udacity-operationalizing-ml/blob/master/4.1-LogsPY.PNG)

This python scripts basically contains the commands needed which will be run using the CLI. (See picture below)

##### Running logs.py file:
![alt text](https://github.com/MarceloLandaverde/udacity-operationalizing-ml/blob/master/4.2-LogsPYCommandLine.PNG)

***Consume Endpoints:***\
Now it is time to consume the deployed model using Swagger. Swagger is a tool that helps build, document, and consume RESTful web services like the one deployed in Azure ML Studio.

##### Interacting with Swagger:
![alt text](https://github.com/MarceloLandaverde/udacity-operationalizing-ml/blob/master/localhost9000.PNG)

##### Interacting with Swagger Deployed Model:
![alt text](https://github.com/MarceloLandaverde/udacity-operationalizing-ml/blob/master/5-Swagger_Instance.PNG)

##### Consuming Endpoint:
![alt text](https://github.com/MarceloLandaverde/udacity-operationalizing-ml/blob/master/6-Consume_End_Point.PNG)

***Publish and Consume a Pipeline***\
Here you can see the already created pipeline which is active:

##### Bankmarketing Train Pipeline:
![alt text](https://github.com/MarceloLandaverde/udacity-operationalizing-ml/blob/master/7-Pipeline_Published_and_Active.PNG)

##### AutoML Module:
![alt text](https://github.com/MarceloLandaverde/udacity-operationalizing-ml/blob/master/8-AutoMLModule.PNG)

##### Use RunDetails Widget:
![alt text](https://github.com/MarceloLandaverde/udacity-operationalizing-ml/blob/master/9-Run_Details_Widget.PNG)


## Screen Recording
Here you can see a short Video which provides a summary of the above listed steps

https://www.youtube.com/watch?hd=1&v=8X3sD2gNi_0&feature=youtu.be

In addition you can see an additional video (deprecated) which shows more detailed information concerning the above listed steps:

https://www.youtube.com/watch?hd=1&v=gJk-ztUjYPw&feature=youtu.be


## Others
Please take into account that the following project concentrates mostly on configuring, deploying and comsuming a model.
Of course it would be possible to go more in depth in other area which are also important. For example:

- Testing "Feature Engineering" within the automl settings.
- Going deeper with the EDA before running the experiment
- Taking care of imbalanced data

The above and other topics will be possible, nevertheless this would "blow up" the scope and the content of this project


 
